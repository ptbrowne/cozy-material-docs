



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Cozy documentation">
      
      
        <link rel="canonical" href="https://docs.cozy.io/cozy-stack/jobs/">
      
      
        <meta name="author" content="CozyCloud - https://cozy.io">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[^a-zа-яё0-9\-]">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.0">
    
    
      
        <title>/jobs - Jobs - Cozy Developer Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.0284f74d.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.01803549.css">
      
      
        
        
        <meta name="theme-color" content="#2196f3">
      
    
    
    
      <script src="../../assets/javascripts/modernizr.74668098.js"></script>
    
    <script type="text/javascript">
        // Used in extra.js, we have to define the variable here since
        // we need access to the "config" jinja variable
        window.outsideDocs = [{"repo": "https://github.com/cozy/cozy-app-publish.git", "name": "cozy-app-publish", "subdir": "."}, {"repo": "https://github.com/cozy/cozy-apps-registry.git", "name": "cozy-apps-registry", "subdir": "."}, {"repo": "https://github.com/cozy/cozy-client.git", "name": "cozy-client", "subdir": "docs"}, {"repo": "https://github.com/cozy/cozy-client-js.git", "name": "cozy-client-js", "subdir": "docs"}, {"repo": "https://github.com/cozy/cozy-ui.git", "name": "cozy-ui", "subdir": "docs"}, {"repo": "https://github.com/cozy/cozy-doctypes.git", "name": "cozy-doctypes", "subdir": "."}, {"repo": "https://github.com/konnectors/libs.git", "name": "cozy-konnector-libs", "subdir": "packages/cozy-konnector-libs/docs"}, {"repo": "https://github.com/CPatchane/create-cozy-app.git", "name": "cozy-scripts", "subdir": "packages/cozy-scripts/docs"}, {"repo": "https://github.com/cozy/cozy-stack.git", "name": "cozy-stack", "subdir": "docs"}, {"repo": "https://github.com/konnectors/konitor.git", "name": "konitor", "subdir": "docs"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "babel-preset-cozy-app", "subdir": "packages/babel-preset-cozy-app"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "commitlint-config-cozy", "subdir": "packages/commitlint-config-cozy"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "cozy-device-helper", "subdir": "packages/cozy-device-helper"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "eslint-config-cozy-app", "subdir": "packages/eslint-config-cozy-app"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "cozy-flags", "subdir": "packages/cozy-flags"}, {"repo": "https://github.com/cozy/cozy-libs.git", "name": "cozy-realtime", "subdir": "packages/cozy-realtime"}]
    </script>

    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700|Ubuntu+Mono&display=fallback">
        <style>body,input{font-family:"Lato","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Ubuntu Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="blue">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#jobs" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://docs.cozy.io/" title="Cozy Developer Documentation" class="md-header-nav__button md-logo">
          
            <i class="md-icon">cloud</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Cozy Developer Documentation
            </span>
            <span class="md-header-nav__topic">
              
                /jobs - Jobs
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/cozy/cozy.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="https://docs.cozy.io/" title="Cozy Developer Documentation" class="md-nav__button md-logo">
      
        <i class="md-icon">cloud</i>
      
    </a>
    Cozy Developer Documentation
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/cozy/cozy.github.io/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Tutorials
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Tutorials
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/app/" title="Create Your Application" class="md-nav__link">
      Create Your Application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/konnector/" title="Develop a Connector" class="md-nav__link">
      Develop a Connector
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../tutorials/selfhost-debian/" title="Self-Host on Debian" class="md-nav__link">
      Self-Host on Debian
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3">
    
    <label class="md-nav__link" for="nav-3">
      How-to
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        How-to
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-1" type="checkbox" id="nav-3-1">
    
    <label class="md-nav__link" for="nav-3-1">
      Dev
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-1">
        Dev
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/dev/runCozyDocker/" title="Run an App in a Cozy using Docker" class="md-nav__link">
      Run an App in a Cozy using Docker
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/dev/hmr/" title="Use Hot Module Replacement in Your App" class="md-nav__link">
      Use Hot Module Replacement in Your App
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/dev/cordova/" title="Make a Mobile App Using Cordova" class="md-nav__link">
      Make a Mobile App Using Cordova
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/dev/connect-mobile-app-local-stack/" title="Connect a Mobile App to Your Local Stack" class="md-nav__link">
      Connect a Mobile App to Your Local Stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/dev/sendmail/" title="Send and Receive E-mails in Development" class="md-nav__link">
      Send and Receive E-mails in Development
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../references/git-flow/" title="Our Front-End Git Flow" class="md-nav__link">
      Our Front-End Git Flow
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../references/tech-intro/" title="Technical introduction to the Cozy platform" class="md-nav__link">
      Technical introduction to the Cozy platform
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3-2" type="checkbox" id="nav-3-2">
    
    <label class="md-nav__link" for="nav-3-2">
      Synchronize
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-3-2">
        Synchronize
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../howTos/sync/linux/" title="Install Cozy Drive on GNU/Linux" class="md-nav__link">
      Install Cozy Drive on GNU/Linux
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4" checked>
    
    <label class="md-nav__link" for="nav-4">
      Stack and tools
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Stack and tools
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../eslint-config-cozy-app/" title="eslint-config-cozy-app" class="md-nav__link">
      eslint-config-cozy-app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../commitlint-config-cozy/" title="commitlint-config-cozy" class="md-nav__link">
      commitlint-config-cozy
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3" type="checkbox" id="nav-4-3" checked>
    
    <label class="md-nav__link" for="nav-4-3">
      cozy-stack
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-3">
        cozy-stack
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3-2" type="checkbox" id="nav-4-3-2">
    
    <label class="md-nav__link" for="nav-4-3-2">
      Usage
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-3-2">
        Usage
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../INSTALL/" title="Install the cozy-stack" class="md-nav__link">
      Install the cozy-stack
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../config/" title="Configuration file" class="md-nav__link">
      Configuration file
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../instance/" title="Managing Instances" class="md-nav__link">
      Managing Instances
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../security/" title="Security" class="md-nav__link">
      Security
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cli/cozy-stack/" title="Manpages of the command-line tool" class="md-nav__link">
      Manpages of the command-line tool
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3-3" type="checkbox" id="nav-4-3-3">
    
    <label class="md-nav__link" for="nav-4-3-3">
      How-to guides for developpers
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-3-3">
        How-to guides for developpers
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../client-app-dev/" title="Develop a client-side app" class="md-nav__link">
      Develop a client-side app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../docker/" title="Running and building Docker images" class="md-nav__link">
      Running and building Docker images
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../doctype/" title="Adding a new doctype" class="md-nav__link">
      Adding a new doctype
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../assets/" title="Working with the stack assets" class="md-nav__link">
      Working with the stack assets
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../release/" title="Build a release" class="md-nav__link">
      Build a release
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../CONTRIBUTING/" title="The contributing guide" class="md-nav__link">
      The contributing guide
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3-4" type="checkbox" id="nav-4-3-4">
    
    <label class="md-nav__link" for="nav-4-3-4">
      Explanations
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-3-4">
        Explanations
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../sharing-design/" title="Sharing design" class="md-nav__link">
      Sharing design
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../konnectors-workflow/" title="Workflow of the konnectors" class="md-nav__link">
      Workflow of the konnectors
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-3-5" type="checkbox" id="nav-4-3-5" checked>
    
    <label class="md-nav__link" for="nav-4-3-5">
      List of services
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="3">
      <label class="md-nav__title" for="nav-4-3-5">
        List of services
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../auth/" title="/auth - Authentication & OAuth" class="md-nav__link">
      /auth - Authentication & OAuth
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../apps/" title="/apps - Applications Management" class="md-nav__link">
      /apps - Applications Management
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../registry/" title="/apps - Apps registry" class="md-nav__link">
       /apps - Apps registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../konnectors/" title="/apps - Konnectors" class="md-nav__link">
       /apps - Konnectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../data-system/" title="/data - Data System" class="md-nav__link">
      /data - Data System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../mango/" title="/data - Mango" class="md-nav__link">
       /data - Mango
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../couchdb-quirks/" title="/data - CouchDB Quirks" class="md-nav__link">
       /data - CouchDB Quirks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../pouchdb-quirks/" title="/data - PouchDB Quirks" class="md-nav__link">
       /data - PouchDB Quirks
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../files/" title="/files - Virtual File System" class="md-nav__link">
      /files - Virtual File System
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../references-docs-in-vfs/" title="/files - References of documents in VFS" class="md-nav__link">
       /files - References of documents in VFS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../intents/" title="/intents - Intents" class="md-nav__link">
      /intents - Intents
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        /jobs - Jobs
      </label>
    
    <a href="./" title="/jobs - Jobs" class="md-nav__link md-nav__link--active">
      /jobs - Jobs
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#triggers" title="Triggers" class="md-nav__link">
    Triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#at-syntax" title="@at syntax" class="md-nav__link">
    @at syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-syntax" title="@in syntax" class="md-nav__link">
    @in syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#every-syntax" title="@every syntax" class="md-nav__link">
    @every syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cron-syntax" title="@cron syntax" class="md-nav__link">
    @cron syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-syntax" title="@event syntax" class="md-nav__link">
    @event syntax
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retry" title="Retry" class="md-nav__link">
    Retry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout" title="Timeout" class="md-nav__link">
    Timeout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defaults" title="Defaults" class="md-nav__link">
    Defaults
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobs-api" title="Jobs API" class="md-nav__link">
    Jobs API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-jobsjob-id" title="GET /jobs/:job-id" class="md-nav__link">
    GET /jobs/:job-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobsqueueworker-type" title="POST /jobs/queue/:worker-type" class="md-nav__link">
    POST /jobs/queue/:worker-type
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_1" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_1" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobsqueueworker-type" title="GET /jobs/queue/:worker-type" class="md-nav__link">
    GET /jobs/queue/:worker-type
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_2" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_2" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_1" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobstriggers" title="POST /jobs/triggers" class="md-nav__link">
    POST /jobs/triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_3" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_3" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_2" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-id" title="GET /jobs/triggers/:trigger-id" class="md-nav__link">
    GET /jobs/triggers/:trigger-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_4" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_4" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_3" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-idstate" title="GET /jobs/triggers/:trigger-id/state" class="md-nav__link">
    GET /jobs/triggers/:trigger-id/state
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_5" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_5" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_4" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-idjobs" title="GET /jobs/triggers/:trigger-id/jobs" class="md-nav__link">
    GET /jobs/triggers/:trigger-id/jobs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_6" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_6" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobstriggerstrigger-idlaunch" title="POST /jobs/triggers/:trigger-id/launch" class="md-nav__link">
    POST /jobs/triggers/:trigger-id/launch
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_7" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_7" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_5" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-jobspurge" title="DELETE /jobs/purge" class="md-nav__link">
    DELETE /jobs/purge
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_8" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_8" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_6" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-jobstriggerstrigger-id" title="DELETE /jobs/triggers/:trigger-id" class="md-nav__link">
    DELETE /jobs/triggers/:trigger-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_9" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_7" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggers" title="GET /jobs/triggers" class="md-nav__link">
    GET /jobs/triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_10" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_9" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_8" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-pool" title="Worker pool" class="md-nav__link">
    Worker pool
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions_9" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-stack" title="Multi-stack" class="md-nav__link">
    Multi-stack
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../workers/" title="/jobs - Workers" class="md-nav__link">
       /jobs - Workers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../move/" title="/move - Move, export and import an instance" class="md-nav__link">
      /move - Move, export and import an instance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../notifications/" title="/notifications - Notifications" class="md-nav__link">
      /notifications - Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../public/" title="/public - Public" class="md-nav__link">
      /public - Public
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../permissions/" title="/permissions - Permissions" class="md-nav__link">
      /permissions - Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../realtime/" title="/realtime - Realtime" class="md-nav__link">
      /realtime - Realtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../remote/" title="/remote - Proxy for remote data/API" class="md-nav__link">
      /remote - Proxy for remote data/API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../settings/" title="/settings - Settings" class="md-nav__link">
      /settings - Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../user-action-required/" title="/settings - Terms of Services" class="md-nav__link">
       /settings - Terms of Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../sharing/" title="/sharings - Sharing" class="md-nav__link">
      /sharings - Sharing
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-app-publish/" title="cozy-app-publish" class="md-nav__link">
      cozy-app-publish
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../babel-preset-cozy-app/" title="babel-preset-cozy-app" class="md-nav__link">
      babel-preset-cozy-app
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../konitor/cli/" title="konitor" class="md-nav__link">
      konitor
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-7" type="checkbox" id="nav-4-7">
    
    <label class="md-nav__link" for="nav-4-7">
      cozy-doctypes
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-7">
        cozy-doctypes
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.accounts/" title="Accounts" class="md-nav__link">
      Accounts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.apps/" title="Apps" class="md-nav__link">
      Apps
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.bank/" title="Banking doctypes" class="md-nav__link">
      Banking doctypes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.bills/" title="Bills" class="md-nav__link">
      Bills
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.konnectors/" title="Connectors" class="md-nav__link">
      Connectors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.contacts/" title="Contacts" class="md-nav__link">
      Contacts
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.files/" title="Files" class="md-nav__link">
      Files
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.files_metadata/" title="Files metadata" class="md-nav__link">
      Files metadata
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.identities/" title="Identities" class="md-nav__link">
      Identities
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.notifications/" title="Notifications" class="md-nav__link">
      Notifications
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.remote.requests/" title="Remote requests" class="md-nav__link">
      Remote requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.sessions.logins/" title="Session logins" class="md-nav__link">
      Session logins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.permissions/" title="Permissions" class="md-nav__link">
      Permissions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.photos.albums/" title="Photos Albums" class="md-nav__link">
      Photos Albums
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.procedures/" title="Procedures" class="md-nav__link">
      Procedures
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.sessions.logins/" title="Sessions Logins" class="md-nav__link">
      Sessions Logins
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.settings/" title="Settings" class="md-nav__link">
      Settings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.sharings/" title="Sharings" class="md-nav__link">
      Sharings
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.account_types/" title="Accounts Types" class="md-nav__link">
      Accounts Types
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/cc.cozycloud.autocategorization/" title="Autocategorization" class="md-nav__link">
      Autocategorization
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.exports/" title="Exports" class="md-nav__link">
      Exports
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.jobs/" title="Jobs" class="md-nav__link">
      Jobs
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.oauth.clients/" title="OAuth Clients" class="md-nav__link">
      OAuth Clients
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.oauth.access_codes/" title="OAuth Access Codes" class="md-nav__link">
      OAuth Access Codes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.triggers/" title="Triggers" class="md-nav__link">
      Triggers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.triggers.state/" title="Triggers state" class="md-nav__link">
      Triggers state
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.remote.requests/" title="Remote requests" class="md-nav__link">
      Remote requests
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.sessions/" title="Sessions" class="md-nav__link">
      Sessions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.shared/" title="Shared" class="md-nav__link">
      Shared
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/io.cozy.terms/" title="Terms" class="md-nav__link">
      Terms
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-doctypes/docs/com.unibet.bets/" title="Bets Unibet" class="md-nav__link">
      Bets Unibet
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-ui/" title="cozy-ui" class="md-nav__link">
      cozy-ui
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-device-helper/" title="cozy-device-helper" class="md-nav__link">
      cozy-device-helper
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-10" type="checkbox" id="nav-4-10">
    
    <label class="md-nav__link" for="nav-4-10">
      cozy-client
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-10">
        cozy-client
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/getting-started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/relationships/" title="Using relationship" class="md-nav__link">
      Using relationship
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/metadata/" title="cozyMetadata maintenance" class="md-nav__link">
      cozyMetadata maintenance
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/react-integration/" title="React integration" class="md-nav__link">
      React integration
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/details/" title="Other details" class="md-nav__link">
      Other details
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/api/cozy-client/" title="Cozy Client API" class="md-nav__link">
      Cozy Client API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/api/cozy-pouch-link/" title="Cozy Pouch Link API" class="md-nav__link">
      Cozy Pouch Link API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client/api/cozy-stack-client/" title="Cozy Stack Client API" class="md-nav__link">
      Cozy Stack Client API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-realtime/" title="cozy-realtime" class="md-nav__link">
      cozy-realtime
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-12" type="checkbox" id="nav-4-12">
    
    <label class="md-nav__link" for="nav-4-12">
      cozy-konnector-libs
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-12">
        cozy-konnector-libs
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/api/" title="API" class="md-nav__link">
      API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/cli/" title="CLI" class="md-nav__link">
      CLI
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/dev/" title="Develop" class="md-nav__link">
      Develop
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/errors/" title="Errors" class="md-nav__link">
      Errors
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/operation-linking/" title="Operation linking" class="md-nav__link">
      Operation linking
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-konnector-libs/synchronization/" title="Synchronization" class="md-nav__link">
      Synchronization
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-apps-registry/" title="cozy-apps-registry" class="md-nav__link">
      cozy-apps-registry
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-flags/" title="cozy-flags" class="md-nav__link">
      cozy-flags
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4-15" type="checkbox" id="nav-4-15">
    
    <label class="md-nav__link" for="nav-4-15">
      cozy-client-js
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="2">
      <label class="md-nav__title" for="nav-4-15">
        cozy-client-js
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/" title="README" class="md-nav__link">
      README
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/intro/" title="Introduction" class="md-nav__link">
      Introduction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/browser-sdk-transition/" title="Transition from cozy-browser-sdk" class="md-nav__link">
      Transition from cozy-browser-sdk
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/offline/" title="How to support offline" class="md-nav__link">
      How to support offline
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/oauth/" title="OAuth guide" class="md-nav__link">
      OAuth guide
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/auth-api/" title="Authentication API" class="md-nav__link">
      Authentication API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/data-api/" title="Data System API" class="md-nav__link">
      Data System API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/files-api/" title="Files API" class="md-nav__link">
      Files API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/jobs-api/" title="Jobs API" class="md-nav__link">
      Jobs API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/intents-api/" title="Intents API" class="md-nav__link">
      Intents API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/settings-api/" title="Settings API" class="md-nav__link">
      Settings API
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../cozy-client-js/sharing-api/" title="Sharing API" class="md-nav__link">
      Sharing API
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#triggers" title="Triggers" class="md-nav__link">
    Triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#at-syntax" title="@at syntax" class="md-nav__link">
    @at syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#in-syntax" title="@in syntax" class="md-nav__link">
    @in syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#every-syntax" title="@every syntax" class="md-nav__link">
    @every syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cron-syntax" title="@cron syntax" class="md-nav__link">
    @cron syntax
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-syntax" title="@event syntax" class="md-nav__link">
    @event syntax
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling" title="Error Handling" class="md-nav__link">
    Error Handling
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#retry" title="Retry" class="md-nav__link">
    Retry
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeout" title="Timeout" class="md-nav__link">
    Timeout
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#defaults" title="Defaults" class="md-nav__link">
    Defaults
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#jobs-api" title="Jobs API" class="md-nav__link">
    Jobs API
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#get-jobsjob-id" title="GET /jobs/:job-id" class="md-nav__link">
    GET /jobs/:job-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobsqueueworker-type" title="POST /jobs/queue/:worker-type" class="md-nav__link">
    POST /jobs/queue/:worker-type
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_1" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_1" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobsqueueworker-type" title="GET /jobs/queue/:worker-type" class="md-nav__link">
    GET /jobs/queue/:worker-type
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_2" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_2" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_1" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobstriggers" title="POST /jobs/triggers" class="md-nav__link">
    POST /jobs/triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_3" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_3" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_2" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-id" title="GET /jobs/triggers/:trigger-id" class="md-nav__link">
    GET /jobs/triggers/:trigger-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_4" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_4" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_3" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-idstate" title="GET /jobs/triggers/:trigger-id/state" class="md-nav__link">
    GET /jobs/triggers/:trigger-id/state
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_5" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_5" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_4" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggerstrigger-idjobs" title="GET /jobs/triggers/:trigger-id/jobs" class="md-nav__link">
    GET /jobs/triggers/:trigger-id/jobs
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_6" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_6" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#post-jobstriggerstrigger-idlaunch" title="POST /jobs/triggers/:trigger-id/launch" class="md-nav__link">
    POST /jobs/triggers/:trigger-id/launch
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_7" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_7" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_5" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-jobspurge" title="DELETE /jobs/purge" class="md-nav__link">
    DELETE /jobs/purge
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_8" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_8" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_6" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#delete-jobstriggerstrigger-id" title="DELETE /jobs/triggers/:trigger-id" class="md-nav__link">
    DELETE /jobs/triggers/:trigger-id
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_9" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_7" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#get-jobstriggers" title="GET /jobs/triggers" class="md-nav__link">
    GET /jobs/triggers
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#request_10" title="Request" class="md-nav__link">
    Request
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#response_9" title="Response" class="md-nav__link">
    Response
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#permissions_8" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worker-pool" title="Worker pool" class="md-nav__link">
    Worker pool
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions_9" title="Permissions" class="md-nav__link">
    Permissions
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#multi-stack" title="Multi-stack" class="md-nav__link">
    Multi-stack
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cozy/cozy.github.io/edit/dev/src/cozy-stack/jobs.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a href="../#table-of-contents">Table of contents</a></p>
<h1 id="jobs">Jobs<a class="headerlink" href="#jobs" title="Permanent link">&para;</a></h1>
<p>Jobs are designed to represent asynchronous tasks that your cozy can execute.
These tasks can be scheduled in advance, recurring or sudden and provide various
services.</p>
<p>At the time, we do not provide &ldquo;generic&rdquo; and programmable tasks. This list of
available workers is part of the defined API.</p>
<p>The job queue can be either local to the cozy-stack when used as a monolithic
instance (self-hosted for instance) or distributed via a redis server for
distributed infrastructures.</p>
<p>This doc introduces two cozy types:</p>
<ul>
<li><code>io.cozy.jobs</code> for jobs</li>
<li><code>io.cozy.triggers</code> for triggers</li>
</ul>
<h2 id="triggers">Triggers<a class="headerlink" href="#triggers" title="Permanent link">&para;</a></h2>
<p>Jobs can be queued up via the <code>/jobs/queue/:worker-type</code> API, for a direct
execution. But it can also be convenient to schedule jobs on some conditions,
and the triggers are the way to do that.</p>
<p>Jobs can be launched by five different types of triggers:</p>
<ul>
<li><code>@at</code> to schedule a one-time job executed after at a specific time in the
  future</li>
<li><code>@in</code> to schedule a one-time job executed after a specific amount of time</li>
<li><code>@every</code> to schedule periodic jobs executed at a given fix interval</li>
<li><code>@cron</code> to schedule recurring jobs scheduled at specific times</li>
<li><code>@event</code> to launch a job after a change on documents in the cozy.</li>
</ul>
<p>These five triggers have specific syntaxes to describe when jobs should be
scheduled. See below for more informations.</p>
<h3 id="at-syntax"><code>@at</code> syntax<a class="headerlink" href="#at-syntax" title="Permanent link">&para;</a></h3>
<p>The <code>@at</code> trigger takes a ISO-8601 formatted string indicating a UTC time in the
future. The date is of this form: <code>YYYY-MM-DDTHH:mm:ss.sssZ</code></p>
<p>Examples</p>
<div class="codehilite"><pre><span></span>@at 2018-12-12T15:36:25.507Z
</pre></div>


<h3 id="in-syntax"><code>@in</code> syntax<a class="headerlink" href="#in-syntax" title="Permanent link">&para;</a></h3>
<p>The <code>@in</code> trigger takes the same duration syntax as <code>@every</code></p>
<p>Examples</p>
<div class="codehilite"><pre><span></span>@in 10m
@in 1h30m
</pre></div>


<h3 id="every-syntax"><code>@every</code> syntax<a class="headerlink" href="#every-syntax" title="Permanent link">&para;</a></h3>
<p>The <code>@every</code> trigger uses the same syntax as golang&rsquo;s <code>time.ParseDuration</code> (but
only support time units above seconds):</p>
<p>A duration string is a possibly signed sequence of decimal numbers, each with
optional fraction and a unit suffix, such as &ldquo;300ms&rdquo;, &ldquo;1.5h&rdquo; or &ldquo;2h45m&rdquo;. Valid
time units are &ldquo;s&rdquo;, &ldquo;m&rdquo;, &ldquo;h&rdquo;.</p>
<p>Examples</p>
<div class="codehilite"><pre><span></span>@every 1.5h   # schedules every 1 and a half hours
@every 30m10s # schedules every 30 minutes and 10 seconds
</pre></div>


<h3 id="cron-syntax"><code>@cron</code> syntax<a class="headerlink" href="#cron-syntax" title="Permanent link">&para;</a></h3>
<p>In order to schedule recurring jobs, the <code>@cron</code> trigger has the syntax using
six fields:</p>
<table>
<thead>
<tr>
<th>Field name</th>
<th>Mandatory?</th>
<th>Allowed values</th>
<th>Allowed special characters</th>
</tr>
</thead>
<tbody>
<tr>
<td>Seconds</td>
<td>Yes</td>
<td>0-59</td>
<td>* / , -</td>
</tr>
<tr>
<td>Minutes</td>
<td>Yes</td>
<td>0-59</td>
<td>* / , -</td>
</tr>
<tr>
<td>Hours</td>
<td>Yes</td>
<td>0-23</td>
<td>* / , -</td>
</tr>
<tr>
<td>Day of month</td>
<td>Yes</td>
<td>1-31</td>
<td>* / , - ?</td>
</tr>
<tr>
<td>Month</td>
<td>Yes</td>
<td>1-12 or JAN-DEC</td>
<td>* / , -</td>
</tr>
<tr>
<td>Day of week</td>
<td>Yes</td>
<td>0-6 or SUN-SAT</td>
<td>* / , - ?</td>
</tr>
</tbody>
</table>
<p>Asterisk ( <code>*</code> )</p>
<p>The asterisk indicates that the cron expression will match for all values of the
field; e.g., using an asterisk in the 5th field (month) would indicate every
month.</p>
<p>Slash ( <code>/</code> )</p>
<p>Slashes are used to describe increments of ranges. For example 3-59/15 in the
1st field (minutes) would indicate the 3rd minute of the hour and every 15
minutes thereafter. The form <code>"*\/..."</code> is equivalent to the form
<code>"first-last/..."</code>, that is, an increment over the largest possible range of the
field. The form <code>"N-/..."</code> is accepted as meaning <code>"N-MAX/..."</code>, that is,
starting at N, use the increment until the end of that specific range. It does
not wrap around.</p>
<p>Comma ( <code>,</code> )</p>
<p>Commas are used to separate items of a list. For example, using <code>"MON,WED,FRI"</code>
in the 5th field (day of week) would mean Mondays, Wednesdays and Fridays.</p>
<p>Hyphen ( <code>-</code> )</p>
<p>Hyphens are used to define ranges. For example, 9-17 would indicate every hour
between 9am and 5pm inclusive.</p>
<p>Question mark ( <code>?</code> )</p>
<p>Question mark may be used instead of <code>*</code> for leaving either day-of-month or
day-of-week blank.</p>
<p>To schedule jobs given an interval:</p>
<p>Examples:</p>
<div class="codehilite"><pre><span></span>@cron 0 0 0 1 1 *  # Run once a year, midnight, Jan. 1st
@cron 0 0 0 1 1 *  # Run once a year, midnight, Jan. 1st
@cron 0 0 0 1 * *  # Run once a month, midnight, first of month
@cron 0 0 0 * * 0  # Run once a week, midnight on Sunday
@cron 0 0 0 * * *  # Run once a day, midnight
@cron 0 0 * * * *  # Run once an hour, beginning of hour
</pre></div>


<h3 id="event-syntax"><code>@event</code> syntax<a class="headerlink" href="#event-syntax" title="Permanent link">&para;</a></h3>
<p>The <code>@event</code> syntax allows to trigger a job when something occurs in the stack.
It follows the same syntax than permissions scope string:</p>
<p><code>type[:verb][:values][:selector]</code></p>
<p>Unlike for permissions string, the verb should be one of <code>CREATED</code>, <code>DELETED</code>,
<code>UPDATED</code>.</p>
<p>The job worker will receive a compound message including original trigger_infos
messages and the event which has triggered it.</p>
<p>Examples</p>
<div class="codehilite"><pre><span></span>@event io.cozy.files // anything happens on files
@event io.cozy.files:CREATED // a file was created
@event io.cozy.files:DELETED:image/jpg:mime // an image was deleted
@event io.cozy.bank.operations:CREATED io.cozy.bank.bills:CREATED // a bank operation or a bill
@event io.cozy.bank.operations:CREATED,UPDATED // a bank operation created or updated
</pre></div>


<h2 id="error-handling">Error Handling<a class="headerlink" href="#error-handling" title="Permanent link">&para;</a></h2>
<p>Jobs can fail to execute their task. We have two ways to parameterize such
cases.</p>
<h3 id="retry">Retry<a class="headerlink" href="#retry" title="Permanent link">&para;</a></h3>
<p>A retry count can be optionally specified to ask the worker to re-execute the
task if it has failed.</p>
<p>Each retry is executed after a configurable delay. The try count is part of the
attributes of the job. Also, each occurring error is kept in the <code>errors</code> field
containing all the errors that may have happened.</p>
<h3 id="timeout">Timeout<a class="headerlink" href="#timeout" title="Permanent link">&para;</a></h3>
<p>A worker may never end. To prevent this, a configurable timeout value is
specified with the job.</p>
<p>If a job does not end after the specified amount of time, it will be aborted. A
timeout is just like another error from the worker and can provoke a retry if
specified.</p>
<h3 id="defaults">Defaults<a class="headerlink" href="#defaults" title="Permanent link">&para;</a></h3>
<p>By default, jobs are parameterized with a maximum of 3 tries with 1 minute
timeout.</p>
<p>These defaults may vary given the workload of the workers.</p>
<h2 id="jobs-api">Jobs API<a class="headerlink" href="#jobs-api" title="Permanent link">&para;</a></h2>
<p>Example and description of the attributes of a <code>io.cozy.jobs</code>:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;domain&quot;</span><span class="o">:</span> <span class="s2">&quot;me.cozy.tools&quot;</span><span class="p">,</span>
  <span class="s2">&quot;worker&quot;</span><span class="o">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>    <span class="c1">// worker type name</span>
  <span class="s2">&quot;options&quot;</span><span class="o">:</span> <span class="p">{</span>
    <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>         <span class="c1">// priority from 1 to 100, higher number is higher priority</span>
    <span class="s2">&quot;timeout&quot;</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span>         <span class="c1">// timeout value in seconds</span>
    <span class="s2">&quot;max_exec_count&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>   <span class="c1">// maximum number of time the job should be executed (including retries)</span>
  <span class="p">},</span>
  <span class="s2">&quot;arguments&quot;</span><span class="o">:</span> <span class="p">{</span>           <span class="c1">// the arguments will be given to the worker (if you look in CouchDB, it is called message there)</span>
    <span class="s2">&quot;mode&quot;</span><span class="o">:</span> <span class="s2">&quot;noreply&quot;</span><span class="p">,</span>
    <span class="s2">&quot;template_name&quot;</span><span class="o">:</span> <span class="s2">&quot;new_registration&quot;</span><span class="p">,</span>
    <span class="s2">&quot;template_values&quot;</span><span class="o">:</span> <span class="p">{</span>
      <span class="s2">&quot;DevicesLink&quot;</span><span class="o">:</span> <span class="s2">&quot;http://me.cozy.tools/#/connectedDevices&quot;</span><span class="p">,</span>
    <span class="p">}</span>
  <span class="p">},</span>
  <span class="s2">&quot;state&quot;</span><span class="o">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>      <span class="c1">// queued, running, errored</span>
  <span class="s2">&quot;queued_at&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>  <span class="c1">// time of the queuing</span>
  <span class="s2">&quot;started_at&quot;</span><span class="o">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span> <span class="c1">// time of first execution</span>
  <span class="s2">&quot;error&quot;</span><span class="o">:</span> <span class="s2">&quot;&quot;</span>             <span class="c1">// error message if any</span>
<span class="p">}</span>
</pre></div>


<p>Example and description of a job creation options — as you can see, the options
are replicated in the <code>io.cozy.jobs</code> attributes:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;priority&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>         <span class="c1">// priority from 1 to 100</span>
  <span class="s2">&quot;timeout&quot;</span><span class="o">:</span> <span class="mi">60</span><span class="p">,</span>         <span class="c1">// timeout value in seconds</span>
  <span class="s2">&quot;max_exec_count&quot;</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>   <span class="c1">// maximum number of retry</span>
<span class="p">}</span>
</pre></div>


<h3 id="get-jobsjob-id">GET /jobs/:job-id<a class="headerlink" href="#get-jobsjob-id" title="Permanent link">&para;</a></h3>
<p>Get a job informations given its ID.</p>
<h4 id="request">Request<a class="headerlink" href="#request" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/123123</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response">Response<a class="headerlink" href="#response" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;me.cozy.tools&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">},</span>
      <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>
      <span class="nt">&quot;queued_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;started_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/123123&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="post-jobsqueueworker-type">POST /jobs/queue/:worker-type<a class="headerlink" href="#post-jobsqueueworker-type" title="Permanent link">&para;</a></h3>
<p>Enqueue programmatically a new job.</p>
<p>This route requires a specific permission on the worker-type. A global
permission on the global <code>io.cozy.jobs</code> doctype is not allowed.</p>
<p>Each <a href="./worker.md">worker</a> accepts different arguments. For konnectors, the
arguments will be given in the <code>COZY_FIELDS</code> env variable.</p>
<h4 id="request_1">Request<a class="headerlink" href="#request_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">POST</span> <span class="nn">/jobs/queue/sendmail</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">},</span>
      <span class="nt">&quot;arguments&quot;</span><span class="p">:</span> <span class="p">{}</span> <span class="err">//</span> <span class="err">any</span> <span class="err">json</span> <span class="err">value</span> <span class="err">used</span> <span class="err">as</span> <span class="err">arguments</span> <span class="err">for</span> <span class="err">the</span> <span class="err">job</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="response_1">Response<a class="headerlink" href="#response_1" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;me.cozy.tools&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">},</span>
      <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>
      <span class="nt">&quot;queued_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;started_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/123123&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions">Permissions<a class="headerlink" href="#permissions" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.jobs</code> for the verb <code>POST</code>. The is required to restrict its permission
to specific worker(s), like this (a global permission on the doctype is not
allowed):</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;mail-from-the-user&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required to send mails from the user to his/her friends&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">],</span>
      <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
      <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sendmail&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="get-jobsqueueworker-type">GET /jobs/queue/:worker-type<a class="headerlink" href="#get-jobsqueueworker-type" title="Permanent link">&para;</a></h3>
<p>List the jobs in the queue.</p>
<h4 id="request_2">Request<a class="headerlink" href="#request_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/queue/sendmail</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_2">Response<a class="headerlink" href="#response_2" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;cozy.tools:8080&quot;</span><span class="p">,</span>
        <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
        <span class="nt">&quot;queued_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-09-29T15:32:31.953878568+02:00&quot;</span><span class="p">,</span>
        <span class="nt">&quot;started_at&quot;</span><span class="p">:</span> <span class="s2">&quot;0001-01-01T00:00:00Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;queued&quot;</span><span class="p">,</span>
        <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;log&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;77689bca9634b4fb08d6ca3d1643de5f&quot;</span><span class="p">,</span>
      <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/log/77689bca9634b4fb08d6ca3d1643de5f&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;rev&quot;</span><span class="p">:</span> <span class="s2">&quot;1-f823bcd2759103a5ad1a98f4bf083b36&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;meta&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;count&quot;</span><span class="p">:</span> <span class="mi">0</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_1">Permissions<a class="headerlink" href="#permissions_1" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.jobs</code> for the verb <code>GET</code>. In most cases, the application will restrict
its permission to only one worker, like this:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;mail-from-the-user&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required to know the number of jobs in the sendmail queues&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;GET&quot;</span><span class="p">],</span>
      <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
      <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sendmail&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="post-jobstriggers">POST /jobs/triggers<a class="headerlink" href="#post-jobstriggers" title="Permanent link">&para;</a></h3>
<p>Add a trigger of the worker. See <a href="#triggers">triggers&rsquo; descriptions</a> to see the
types of trigger and their arguments syntax.</p>
<p>This route requires a specific permission on the worker type. A global
permission on the global <code>io.cozy.triggers</code> doctype is not allowed.</p>
<p>The <code>debounce</code> parameter can be used to limit the number of jobs created in a
burst. It delays the creation of the job on the first input by the given time
argument, and if the trigger has its condition matched again during this period,
it won&rsquo;t create another job. It can be useful to combine it with the changes
feed of couchdb with a last sequence number persisted by the worker, as it
allows to have a nice diff between two executions of the worker.</p>
<h4 id="request_3">Request<a class="headerlink" href="#request_3" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">POST</span> <span class="nn">/jobs/triggers</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;@event&quot;</span><span class="p">,</span>
      <span class="nt">&quot;arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.invitations&quot;</span><span class="p">,</span>
      <span class="nt">&quot;debounce&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p><strong>Note</strong>: the <code>message</code> field was previously called <code>worker_arguments</code>. The
latter version still works but is deprecated, you should use <code>message</code> instead.</p>
<h4 id="response_3">Response<a class="headerlink" href="#response_3" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.triggers&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;@every&quot;</span><span class="p">,</span>
      <span class="nt">&quot;arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;30m10s&quot;</span><span class="p">,</span>
      <span class="nt">&quot;debounce&quot;</span><span class="p">:</span> <span class="s2">&quot;10m&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/triggers/123123&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_2">Permissions<a class="headerlink" href="#permissions_2" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>POST</code>. In most cases, the application will
restrict its permission to only one worker, like this:</p>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;permissions&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;mail-from-the-user&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;Required to send regularly mails from the user to his/her friends&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.triggers&quot;</span><span class="p">,</span>
      <span class="nt">&quot;verbs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;POST&quot;</span><span class="p">],</span>
      <span class="nt">&quot;selector&quot;</span><span class="p">:</span> <span class="s2">&quot;worker&quot;</span><span class="p">,</span>
      <span class="nt">&quot;values&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;sendmail&quot;</span><span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h3 id="get-jobstriggerstrigger-id">GET /jobs/triggers/:trigger-id<a class="headerlink" href="#get-jobstriggerstrigger-id" title="Permanent link">&para;</a></h3>
<p>Get a trigger informations given its ID.</p>
<h4 id="request_4">Request<a class="headerlink" href="#request_4" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/triggers/123123</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_4">Response<a class="headerlink" href="#response_4" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.triggers&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;@every&quot;</span><span class="p">,</span>
      <span class="nt">&quot;arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;30m10s&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;priority&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
        <span class="nt">&quot;timeout&quot;</span><span class="p">:</span> <span class="mi">60</span><span class="p">,</span>
        <span class="nt">&quot;max_exec_count&quot;</span><span class="p">:</span> <span class="mi">3</span>
      <span class="p">},</span>
      <span class="nt">&quot;current_state&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;done&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_success&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_successful_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_executed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_failed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_error&quot;</span><span class="p">:</span> <span class="s2">&quot;error value&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_manual_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_manual_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/triggers/123123&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_3">Permissions<a class="headerlink" href="#permissions_3" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>GET</code>.</p>
<h3 id="get-jobstriggerstrigger-idstate">GET /jobs/triggers/:trigger-id/state<a class="headerlink" href="#get-jobstriggerstrigger-idstate" title="Permanent link">&para;</a></h3>
<p>Get the trigger current state, to give a big picture of the health of the
trigger.</p>
<ul>
<li>last executed job status (<code>done</code>, <code>errored</code>, <code>queued</code> or <code>running</code>)</li>
<li>last executed job that resulted in a successful executoin</li>
<li>last executed job that resulted in an error</li>
<li>last executed job from a manual execution (not executed by the trigger
  directly)</li>
</ul>
<h4 id="request_5">Request<a class="headerlink" href="#request_5" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/triggers/123123/state</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_5">Response<a class="headerlink" href="#response_5" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs.state&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;done&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_success&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_successful_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_executed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_failed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_error&quot;</span><span class="p">:</span> <span class="s2">&quot;error value&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_manual_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2017-11-20T13:31:09.01641731&quot;</span><span class="p">,</span>
      <span class="nt">&quot;last_manual_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcde&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_4">Permissions<a class="headerlink" href="#permissions_4" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>GET</code>.</p>
<p>Also, for konnector trigger, any application sharing the same doctype
permissions as the konnector launched by the trigger will be granted the
permissions to fetch its state, even without permissions on the
<code>io.cozy.triggers</code> doctype.</p>
<h3 id="get-jobstriggerstrigger-idjobs">GET /jobs/triggers/:trigger-id/jobs<a class="headerlink" href="#get-jobstriggerstrigger-idjobs" title="Permanent link">&para;</a></h3>
<p>Get the jobs launched by the trigger with the specified ID.</p>
<p>Query parameters:</p>
<ul>
<li><code>Limit</code>: to specify the number of jobs to get out</li>
</ul>
<h4 id="request_6">Request<a class="headerlink" href="#request_6" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/triggers/123123/jobs?Limit=1</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_6">Response<a class="headerlink" href="#response_6" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
      <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/123123&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h3 id="post-jobstriggerstrigger-idlaunch">POST /jobs/triggers/:trigger-id/launch<a class="headerlink" href="#post-jobstriggerstrigger-idlaunch" title="Permanent link">&para;</a></h3>
<p>Launch a trigger manually given its ID and return the created job.</p>
<h4 id="request_7">Request<a class="headerlink" href="#request_7" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">POST</span> <span class="nn">/jobs/triggers/123123/launch</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_7">Response<a class="headerlink" href="#response_7" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.jobs&quot;</span><span class="p">,</span>
    <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
    <span class="nt">&quot;attributes&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;me.cozy.tools&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;sendmail&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">{},</span>
      <span class="nt">&quot;state&quot;</span><span class="p">:</span> <span class="s2">&quot;running&quot;</span><span class="p">,</span>
      <span class="nt">&quot;queued_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;started_at&quot;</span><span class="p">:</span> <span class="s2">&quot;2016-09-19T12:35:08Z&quot;</span><span class="p">,</span>
      <span class="nt">&quot;error&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span>
    <span class="p">},</span>
    <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/123123&quot;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_5">Permissions<a class="headerlink" href="#permissions_5" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>POST</code>.</p>
<h3 id="delete-jobspurge">DELETE /jobs/purge<a class="headerlink" href="#delete-jobspurge" title="Permanent link">&para;</a></h3>
<p>This endpoint allows to purge old jobs of an instance.
Some parameters can be given to this route:</p>
<ul>
<li><code>duration</code> is the duration of jobs to keep. This is a human-readable string
  (integer+suffix).
  For example:</li>
<li>&ldquo;3W&rdquo; will keep jobs up to 3 weeks</li>
<li>&ldquo;2M&rdquo; will keep jobs up to 2 months</li>
<li><code>workers</code> is a comma-separated list of workers to apply the purge job.</li>
</ul>
<h4 id="request_8">Request<a class="headerlink" href="#request_8" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">DELETE</span> <span class="nn">/jobs/purge</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/json</span>
</pre></div>


<h4 id="response_8">Response<a class="headerlink" href="#response_8" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;deleted&quot;</span><span class="p">:</span> <span class="mi">42</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_6">Permissions<a class="headerlink" href="#permissions_6" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.jobs</code> for the verb <code>DELETE</code>.</p>
<h3 id="delete-jobstriggerstrigger-id">DELETE /jobs/triggers/:trigger-id<a class="headerlink" href="#delete-jobstriggerstrigger-id" title="Permanent link">&para;</a></h3>
<p>Delete a trigger given its ID.</p>
<h4 id="request_9">Request<a class="headerlink" href="#request_9" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">DELETE</span> <span class="nn">/jobs/triggers/123123</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="permissions_7">Permissions<a class="headerlink" href="#permissions_7" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>DELETE</code>.</p>
<p>Also, for konnector trigger, any application sharing the same doctype
permissions as the konnector launched by the trigger will be granted the
permissions to delete the trigger, even without permissions on the
<code>io.cozy.triggers</code> doctype.</p>
<h3 id="get-jobstriggers">GET /jobs/triggers<a class="headerlink" href="#get-jobstriggers" title="Permanent link">&para;</a></h3>
<p>Get the list of triggers. This route only accept <code>Worker</code> query parameters and returns the trigger but also in <code>attributes</code> its <code>current_state</code> (the same <code>current_state</code> returned by <a href="jobs/#get-jobstriggerstrigger-id">GET /jobs/triggers/:trigger-id</a>). Be warned that <code>/data/io.cozy.triggers/_find</code> does not return this <code>current_state</code> attribute and you&rsquo;ll need to query <code>/jobs/triggers/:trigger-id</code> to have it.</p>
<p>Query parameters:</p>
<ul>
<li><code>Worker</code>: to filter only triggers associated with a specific worker.</li>
</ul>
<h4 id="request_10">Request<a class="headerlink" href="#request_10" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="nf">GET</span> <span class="nn">/jobs/triggers?Worker=konnector</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">application/vnd.api+json</span>
</pre></div>


<h4 id="response_9">Response<a class="headerlink" href="#response_9" title="Permanent link">&para;</a></h4>
<div class="codehilite"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;io.cozy.triggers&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
      <span class="nt">&quot;arguments&quot;</span><span class="p">:</span> <span class="s2">&quot;0 40 0 * * *&quot;</span><span class="p">,</span>
      <span class="nt">&quot;current_state&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;last_error&quot;</span><span class="p">:</span> <span class="s2">&quot;LOGIN_FAILED&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_executed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abc&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-07T08:23:22.069902888Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_failed_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;abcd&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_failure&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-07T08:23:22.069902888Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_manual_execution&quot;</span><span class="p">:</span> <span class="s2">&quot;2019-01-07T08:23:22.069902888Z&quot;</span><span class="p">,</span>
        <span class="nt">&quot;last_manual_job_id&quot;</span><span class="p">:</span> <span class="s2">&quot;azer&quot;</span><span class="p">,</span>
        <span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;errored&quot;</span><span class="p">,</span>
        <span class="nt">&quot;trigger_id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;debounce&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
      <span class="nt">&quot;domain&quot;</span><span class="p">:</span> <span class="s2">&quot;xxx.mycozy.cloud&quot;</span><span class="p">,</span>
      <span class="nt">&quot;message&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;konnector&quot;</span><span class="p">:</span> <span class="s2">&quot;slug&quot;</span><span class="p">,</span> 
        <span class="nt">&quot;account&quot;</span><span class="p">:</span> <span class="s2">&quot;XXX&quot;</span>
      <span class="p">},</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="kc">null</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;@cron&quot;</span><span class="p">,</span>
      <span class="nt">&quot;worker&quot;</span><span class="p">:</span> <span class="s2">&quot;konnector&quot;</span><span class="p">,</span>
      <span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;123123&quot;</span><span class="p">,</span>
      <span class="nt">&quot;links&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;self&quot;</span><span class="p">:</span> <span class="s2">&quot;/jobs/triggers/123123&quot;</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>


<h4 id="permissions_8">Permissions<a class="headerlink" href="#permissions_8" title="Permanent link">&para;</a></h4>
<p>To use this endpoint, an application needs a permission on the type
<code>io.cozy.triggers</code> for the verb <code>GET</code>. When used on a specific worker, the
permission can be specified on the <code>worker</code> field.</p>
<h2 id="worker-pool">Worker pool<a class="headerlink" href="#worker-pool" title="Permanent link">&para;</a></h2>
<p>The consuming side of the job queue is handled by a worker pool.</p>
<p>On a monolithic cozy-stack, the worker pool has a configurable fixed size of
workers. The default value is not yet determined. Each time a worker has
finished a job, it check the queue and based on the priority and the queued date
of the job, picks a new job to execute.</p>
<h2 id="permissions_9">Permissions<a class="headerlink" href="#permissions_9" title="Permanent link">&para;</a></h2>
<p>In order to prevent jobs from leaking informations between applications, we may
need to add filtering per applications: for instance one queue per applications.</p>
<p>We should also have an explicit check on the permissions of the applications
before launching a job scheduled by an application. For more information, refer
to our <a href="./permissions">permission document</a>.</p>
<h2 id="multi-stack">Multi-stack<a class="headerlink" href="#multi-stack" title="Permanent link">&para;</a></h2>
<p>When some instances are served by several stacks, the scheduling and running of
jobs can be distributed on the stacks. The synchronization is done via redis.</p>
<p>For scheduling, there is one important key in redis: <code>triggers</code>. It&rsquo;s a sorted
set. The members are the identifiants of the triggers (with the domain name),
and the score are the timestamp of the next time the trigger should occur.
During the short period of time where a trigger is processed, its key is moved
to <code>scheduling</code> (another sorted set). So, even if a stack crash during
processing a trigger, this trigger won&rsquo;t be lost.</p>
<p>For <code>@event</code> triggers, we don&rsquo;t use the same mechanism. Each stack has all the
triggers in memory and is responsible to trigger them for the events generated
by the HTTP requests of their API. They also publish them on redis: this pub/sub
is used for the realtime API.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../intents/" title="/intents - Intents" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                /intents - Intents
              </span>
            </div>
          </a>
        
        
          <a href="../workers/" title=" /jobs - Workers" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                 /jobs - Workers
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.245445c6.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="../../extra.js"></script>
      
    
  </body>
</html>